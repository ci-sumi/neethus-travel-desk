{% extends "index.html" %}

{% block content %}
<div class="d-flex justify-content-center align-items-center vh-80">
    <div class="container text-center mt-4 mb-5" style="max-width: 400px; background-color: #87CEEB; padding: 1.5rem; border-radius: 8px;">
        <h2 class="mb-4" style="font-size: 1.75rem;">Travel Budget Calculator</h2>

        <!-- Display any error messages from the form -->
        {% if form.destination.errors %}
        <div class="alert alert-danger" role="alert">
            <strong>Please provide a destination!</strong> {{ form.destination.errors|striptags }}
        </div>
        {% endif %}

        <!-- Budget Form -->
        <form method="post" id="budget-form">
            {% csrf_token %}
            {{ form.as_p }}
            <div class="d-flex justify-content-between mt-4">
                <button type="submit" class="btn btn-primary">Calculate Total Budget</button>
                <button type="button" class="btn btn-secondary" onclick="openClearModal()">Clear</button>
            </div>
        </form>

        {% if total_cost is not None %}
        <div class="alert alert-success mt-4" role="alert">
            <h4>Total Estimated Budget: <span class="text-success">${{ total_cost|default:"0" }}</span></h4>
        </div>
        {% endif %}
    </div>
</div>

<!-- Clear Fields Confirmation Modal -->
<div class="modal-overlay" id="clearModal" style="display: none;">
    <div class="modal-content">
        <h2>Are you sure you want to clear all fields?</h2>
        <button type="button" class="btn btn-danger" onclick="clearForm()">Yes, clear</button>
        <button type="button" class="btn btn-secondary" onclick="closeClearModal()">Cancel</button>
    </div>
</div>

{% endblock %}

{% block style %}
<style>
    /* Modal styling here */
    .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 1000;
    }
    .modal-content {
        background: #fff;
        padding: 25px 20px;
        border-radius: 8px;
        width: 90%;
        max-width: 400px;
        text-align: center;
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
    }
    .btn-danger, .btn-secondary {
        padding: 10px 20px;
        border-radius: 4px;
        cursor: pointer;
        color: #fff;
        border: none;
        margin-right: 10px;
        transition: background-color 0.2s ease;
    }
    .btn-danger {
        background-color: #d9534f;
    }
    .btn-secondary {
        background-color: #6c757d;
    }
    .btn-danger:hover {
        background-color: #c9302c;
    }
    .btn-secondary:hover {
        background-color: #5a6268;
    }
</style>
{% endblock %}

{% block script %}
<!-- JavaScript to handle modal and clearing form -->
<script>
    // Function to open the clear confirmation modal
    function openClearModal() {
        document.getElementById("clearModal").style.display = "flex";
    }

    // Function to close the clear confirmation modal
    function closeClearModal() {
        document.getElementById("clearModal").style.display = "none";
    }

    // Function to clear form fields and close the modal
   // Function to clear the form
  // Function to clear form fields and close the modal
function clearForm() {
    // Get the form element
    const form = document.getElementById("budget-form");
    
    // Reset all input fields
    form.reset();  // Reset all form fields (this works for most inputs)

    // Clear the values for any number inputs explicitly
    const numberInputs = form.querySelectorAll('input[type="number"]');
    numberInputs.forEach(input => {
        input.value = ''; // Explicitly clear number inputs
    });

    // Clear any select dropdowns (destination is a select element)
    const selectInputs = form.querySelectorAll('select');
    selectInputs.forEach(select => {
        select.selectedIndex = 0; // Reset the select dropdown to no selection
    });

    const totalCostAlert = document.querySelector(".alert-success");
    if (totalCostAlert) {
        totalCostAlert.style.display = "none"; // Hide the total cost alert after clearing
    }


    // Close the modal
    closeClearModal();
}

// Function to open the clear confirmation modal
function openClearModal() {
    document.getElementById("clearModal").style.display = "flex";
}

// Function to close the clear confirmation modal
function closeClearModal() {
    document.getElementById("clearModal").style.display = "none";
}


</script>
{% endblock %}
